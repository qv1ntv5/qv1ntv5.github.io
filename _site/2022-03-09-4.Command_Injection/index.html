<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>4. Command Injection.</title>

  
  <meta name="author" content="Qv1nTv5">
  

  <meta name="description" content="Detección y explotación de vulnerabilidades de inyección de comandos a través de la herramienta BurpSuite.">

  

  

  
  <link rel="alternate" type="application/rss+xml" title="Home" href="http://localhost:4000/feed.xml">
  

  

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Home">
  <meta property="og:title" content="4. Command Injection.">
  <meta property="og:description" content="Detección y explotación de vulnerabilidades de inyección de comandos a través de la herramienta BurpSuite.">

  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Qv1nTv5">
  <meta property="og:article:published_time" content="2022-03-09T00:00:00-05:00">
  <meta property="og:url" content="http://localhost:4000/2022-03-09-4.Command_Injection/">
  <link rel="canonical" href="http://localhost:4000/2022-03-09-4.Command_Injection/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@Qvintvs1">
  <meta name="twitter:creator" content="@Qvintvs1">

  <meta property="twitter:title" content="4. Command Injection.">
  <meta property="twitter:description" content="Detección y explotación de vulnerabilidades de inyección de comandos a través de la herramienta BurpSuite.">

  

  


  

  

</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand" href="http://localhost:4000/">Home</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Program</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/Cpage">C</a>
                  <a class="dropdown-item" href="/DHARMApage">Dharma</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Pentest</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/BURPSUITEpage">Burp</a>
                  <a class="dropdown-item" href="/THMpage">Thm</a>
                  <a class="dropdown-item" href="/HackTheBoxpage">Htb</a>
                  <a class="dropdown-item" href="/PEN200page">BasicPentesting</a>
                  <a class="dropdown-item" href="/REDTEAMBASICSpage">RedTeam</a>
                  <a class="dropdown-item" href="/BLUETEAMBASICSpage">Blueteam</a>
                  <a class="dropdown-item" href="/REDESpage">Net</a>
                  <a class="dropdown-item" href="/2022-11-17-GitBasics">Git</a>
            </div>
          </li>
        
        <li class="nav-item">
          <a class="nav-link" id="nav-search-link" href="#" title="Search">
            <span id="nav-search-icon" class="fa fa-search"></span>
            <span id="nav-search-text">Search</span>
          </a>
        </li></ul>
  </div>

  

  

</nav>



<div id="beautifuljekyll-search-overlay">

  <div id="nav-search-exit" title="Exit search">✕</div>
  <input type="text" id="nav-search-input" placeholder="Search">
  <ul id="search-results-container"></ul>
  
  <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
  <script>
    var searchjson = '[ \
       \
        { \
          "title"    : "2. Constants and Literals in C.", \
          "category" : "C", \
          "url"      : "/2024-12-10-1.ConstantsinC-copy/", \
          "date"     : "December 10, 2024" \
        }, \
       \
        { \
          "title"    : "1. Basics of C", \
          "category" : "C", \
          "url"      : "/2024-12-02-1.BasicsOfC/", \
          "date"     : "December  2, 2024" \
        }, \
       \
        { \
          "title"    : "Gramáticas en Dharma", \
          "category" : "DHA", \
          "url"      : "/2024-09-24-Dharma_Tutorial/", \
          "date"     : "September 24, 2024" \
        }, \
       \
        { \
          "title"    : "Gramáticas en Dharma", \
          "category" : "fuzz", \
          "url"      : "/2024-03-22-Dharma_Tutorial-copy/", \
          "date"     : "March 22, 2024" \
        }, \
       \
        { \
          "title"    : "Mi experiencia con el OSCP", \
          "category" : "pen", \
          "url"      : "/2023-11-19-PEN200_Experience/", \
          "date"     : "November 19, 2023" \
        }, \
       \
        { \
          "title"    : "Client Side", \
          "category" : "pen", \
          "url"      : "/2023-11-17-17.Client_Side_Attacks/", \
          "date"     : "November 17, 2023" \
        }, \
       \
        { \
          "title"    : "Deep Packet Tunneling", \
          "category" : "pen", \
          "url"      : "/2023-11-16-16.Tunneling_Through_Deep_Packet_Inspection/", \
          "date"     : "November 16, 2023" \
        }, \
       \
        { \
          "title"    : "Report", \
          "category" : "pen", \
          "url"      : "/2023-11-15-15.Making_Reports/", \
          "date"     : "November 15, 2023" \
        }, \
       \
        { \
          "title"    : "Metasploit", \
          "category" : "pen", \
          "url"      : "/2023-11-14-14.Metasploit/", \
          "date"     : "November 14, 2023" \
        }, \
       \
        { \
          "title"    : "Password Attacks", \
          "category" : "pen", \
          "url"      : "/2023-11-13-13.Password_Attacks/", \
          "date"     : "November 13, 2023" \
        }, \
       \
        { \
          "title"    : "Active Directory Attacks", \
          "category" : "pen", \
          "url"      : "/2023-11-12-12.Active_Directory_Attacks/", \
          "date"     : "November 12, 2023" \
        }, \
       \
        { \
          "title"    : "Port Forwarding", \
          "category" : "pen", \
          "url"      : "/2023-11-11-11.Port_Forwarding/", \
          "date"     : "November 11, 2023" \
        }, \
       \
        { \
          "title"    : "Privilege Escalation", \
          "category" : "pen", \
          "url"      : "/2023-11-10-10.Privilege_Escalation/", \
          "date"     : "November 10, 2023" \
        }, \
       \
        { \
          "title"    : "File Transfers", \
          "category" : "pen", \
          "url"      : "/2023-11-09-9.File_Tranfers/", \
          "date"     : "November  9, 2023" \
        }, \
       \
        { \
          "title"    : "Buffer Overflows", \
          "category" : "pen", \
          "url"      : "/2023-11-08-8.Buffer_Overflows/", \
          "date"     : "November  8, 2023" \
        }, \
       \
        { \
          "title"    : "Vulnerability Scanning.", \
          "category" : "pen", \
          "url"      : "/2023-11-07-7.Vulnerability_Scanning/", \
          "date"     : "November  7, 2023" \
        }, \
       \
        { \
          "title"    : "Information Gathering", \
          "category" : "pen", \
          "url"      : "/2023-11-06-6.Active_Information_Gathering/", \
          "date"     : "November  6, 2023" \
        }, \
       \
        { \
          "title"    : "Windows", \
          "category" : "pen", \
          "url"      : "/2023-11-05-5.Windows/", \
          "date"     : "November  5, 2023" \
        }, \
       \
        { \
          "title"    : "Networking", \
          "category" : "pen", \
          "url"      : "/2023-11-04-4.Networking/", \
          "date"     : "November  4, 2023" \
        }, \
       \
        { \
          "title"    : "Scripting", \
          "category" : "pen", \
          "url"      : "/2023-11-03-3.Scripting/", \
          "date"     : "November  3, 2023" \
        }, \
       \
        { \
          "title"    : "Practical Tools", \
          "category" : "pen", \
          "url"      : "/2023-11-02-2.PracticalTools/", \
          "date"     : "November  2, 2023" \
        }, \
       \
        { \
          "title"    : "Linux", \
          "category" : "pen", \
          "url"      : "/2023-11-01-1.Linux/", \
          "date"     : "November  1, 2023" \
        }, \
       \
        { \
          "title"    : "Easy", \
          "category" : "hack", \
          "url"      : "/2022-12-01-Easy/", \
          "date"     : "December  1, 2022" \
        }, \
       \
        { \
          "title"    : "Git Basics", \
          "category" : "", \
          "url"      : "/2022-11-17-GitBasics/", \
          "date"     : "November 17, 2022" \
        }, \
       \
        { \
          "title"    : "Tier I", \
          "category" : "hack", \
          "url"      : "/2022-11-10-Tier_1/", \
          "date"     : "November 10, 2022" \
        }, \
       \
        { \
          "title"    : "Tier 0", \
          "category" : "hack", \
          "url"      : "/2022-11-09-Tier_0/", \
          "date"     : "November  9, 2022" \
        }, \
       \
        { \
          "title"    : "7.BufferOverflow.", \
          "category" : "thm", \
          "url"      : "/2022-11-02-7.BufferOverflow/", \
          "date"     : "November  2, 2022" \
        }, \
       \
        { \
          "title"    : "6.Offensive Pentesting", \
          "category" : "thm", \
          "url"      : "/2022-11-01-6.OffensivePentesting/", \
          "date"     : "November  1, 2022" \
        }, \
       \
        { \
          "title"    : "5.RedTeam", \
          "category" : "thm", \
          "url"      : "/2022-10-30-5.RedTeam/", \
          "date"     : "October 30, 2022" \
        }, \
       \
        { \
          "title"    : "4.Windows", \
          "category" : "thm", \
          "url"      : "/2022-10-22-4.Windows/", \
          "date"     : "October 22, 2022" \
        }, \
       \
        { \
          "title"    : "3.Junior Penetrationtester path", \
          "category" : "thm", \
          "url"      : "/2022-09-02-3.JRPenetrationTester/", \
          "date"     : "September  2, 2022" \
        }, \
       \
        { \
          "title"    : "2.Complete Begginer path.", \
          "category" : "thm", \
          "url"      : "/2022-08-07-2.CompleteBegginer/", \
          "date"     : "August  7, 2022" \
        }, \
       \
        { \
          "title"    : "1.Pre-Security path.", \
          "category" : "thm", \
          "url"      : "/2022-07-11-1Pre-Security/", \
          "date"     : "July 11, 2022" \
        }, \
       \
        { \
          "title"    : "0.Scripting for pentesters.", \
          "category" : "thm", \
          "url"      : "/2022-07-10-0.Scripting_for_pentesters/", \
          "date"     : "July 10, 2022" \
        }, \
       \
        { \
          "title"    : "Burp Certified Practitioner Practice Exam.", \
          "category" : "burp", \
          "url"      : "/2022-03-30-PracticeExam/", \
          "date"     : "March 30, 2022" \
        }, \
       \
        { \
          "title"    : "22. OAuth Authentication.", \
          "category" : "burp", \
          "url"      : "/2022-03-27-22.OAuth_authentication/", \
          "date"     : "March 27, 2022" \
        }, \
       \
        { \
          "title"    : "21. HTTP Request Smuggling.", \
          "category" : "burp", \
          "url"      : "/2022-03-26-21.HTTP_request_smuggling/", \
          "date"     : "March 26, 2022" \
        }, \
       \
        { \
          "title"    : "20. HTTP Host Header Attacks.", \
          "category" : "burp", \
          "url"      : "/2022-03-25-20.HTTP_Host_header_attacks/", \
          "date"     : "March 25, 2022" \
        }, \
       \
        { \
          "title"    : "19. Web Cache Poisoning.", \
          "category" : "burp", \
          "url"      : "/2022-03-24-19.Web_cache_poisoning/", \
          "date"     : "March 24, 2022" \
        }, \
       \
        { \
          "title"    : "18. Server-Side Template Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-23-18.Serve-side_template_injection/", \
          "date"     : "March 23, 2022" \
        }, \
       \
        { \
          "title"    : "17. Insecure Deserialization.", \
          "category" : "burp", \
          "url"      : "/2022-03-22-17.Insecure_deserialization/", \
          "date"     : "March 22, 2022" \
        }, \
       \
        { \
          "title"    : "16. WebSockets.", \
          "category" : "burp", \
          "url"      : "/2022-03-21-16.WebSockets/", \
          "date"     : "March 21, 2022" \
        }, \
       \
        { \
          "title"    : "15.DOM-based XSS vulnerabilities.", \
          "category" : "burp", \
          "url"      : "/2022-03-20-15-DOM-based_vulnerabilities/", \
          "date"     : "March 20, 2022" \
        }, \
       \
        { \
          "title"    : "14. Clickjacking.", \
          "category" : "burp", \
          "url"      : "/2022-03-19-14.Clickjacking/", \
          "date"     : "March 19, 2022" \
        }, \
       \
        { \
          "title"    : "13. Cross-Origin Resource Sharing.", \
          "category" : "burp", \
          "url"      : "/2022-03-18-13.Cross-origin_resource_sharing_(CORS)/", \
          "date"     : "March 18, 2022" \
        }, \
       \
        { \
          "title"    : "12. Cross-Site Request Forgery.", \
          "category" : "burp", \
          "url"      : "/2022-03-17-12.Cross-site_request_forgery_(CSRF)/", \
          "date"     : "March 17, 2022" \
        }, \
       \
        { \
          "title"    : "11. Cross-Site Scripting.", \
          "category" : "burp", \
          "url"      : "/2022-03-16-11.Cross-site_scripting_(XSS)/", \
          "date"     : "March 16, 2022" \
        }, \
       \
        { \
          "title"    : "10. XXE Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-15-10.XXE_injection/", \
          "date"     : "March 15, 2022" \
        }, \
       \
        { \
          "title"    : "9. Server-Side Request Forgery.", \
          "category" : "burp", \
          "url"      : "/2022-03-14-9.Server-side_request_forgery/", \
          "date"     : "March 14, 2022" \
        }, \
       \
        { \
          "title"    : "8. File Upload.", \
          "category" : "burp", \
          "url"      : "/2022-03-13-8.File_upload_vulnerabilities/", \
          "date"     : "March 13, 2022" \
        }, \
       \
        { \
          "title"    : "7. Access Control.", \
          "category" : "burp", \
          "url"      : "/2022-03-12-7.Access_control/", \
          "date"     : "March 12, 2022" \
        }, \
       \
        { \
          "title"    : "6. Information Disclosure.", \
          "category" : "burp", \
          "url"      : "/2022-03-11-6.Information_disclosure/", \
          "date"     : "March 11, 2022" \
        }, \
       \
        { \
          "title"    : "5. Bussiness Logic Vulnerabilities.", \
          "category" : "burp", \
          "url"      : "/2022-03-10-5.Business_logic_vulnerabilities/", \
          "date"     : "March 10, 2022" \
        }, \
       \
        { \
          "title"    : "4. Command Injection.", \
          "category" : "burp", \
          "url"      : "/2022-03-09-4.Command_Injection/", \
          "date"     : "March  9, 2022" \
        }, \
       \
        { \
          "title"    : "3. Directory Traversal.", \
          "category" : "burp", \
          "url"      : "/2022-03-08-3.Directory_Traversal/", \
          "date"     : "March  8, 2022" \
        }, \
       \
        { \
          "title"    : "2. Authentication.", \
          "category" : "burp", \
          "url"      : "/2022-03-07-2.Authentication/", \
          "date"     : "March  7, 2022" \
        }, \
       \
        { \
          "title"    : "1. SQLInjection", \
          "category" : "burp", \
          "url"      : "/2022-03-06-1.SQLInjection/", \
          "date"     : "March  6, 2022" \
        }, \
       \
        { \
          "title"    : "Seguridad Perimetral", \
          "category" : "blueteam", \
          "url"      : "/2022-02-09-Seguridad_Perimetral/", \
          "date"     : "February  9, 2022" \
        }, \
       \
        { \
          "title"    : "Hardening de sistemas", \
          "category" : "blueteam", \
          "url"      : "/2022-02-09-Hardening_de_sistemas/", \
          "date"     : "February  9, 2022" \
        }, \
       \
        { \
          "title"    : "Bandit", \
          "category" : "otw", \
          "url"      : "/2022-02-08-Bandit/", \
          "date"     : "February  8, 2022" \
        }, \
       \
        { \
          "title"    : "Proxy", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Proxys/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Protocolos Relevantes", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Protocolos_Importantes/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Curso Básico Redes", \
          "category" : "redes", \
          "url"      : "/2022-02-07-Precurso_Redes/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "IPs", \
          "category" : "redes", \
          "url"      : "/2022-02-07-IPs/", \
          "date"     : "February  7, 2022" \
        }, \
       \
        { \
          "title"    : "Movimientos Laterales", \
          "category" : "redteam", \
          "url"      : "/2022-02-06-Introducci%C3%B3n_a_movimientos_laterales/", \
          "date"     : "February  6, 2022" \
        }, \
       \
        { \
          "title"    : "Evasión de Defensas", \
          "category" : "redteam", \
          "url"      : "/2022-02-05-Evasi%C3%B3n_de_Defensas/", \
          "date"     : "February  5, 2022" \
        }, \
       \
        { \
          "title"    : "Escalada de privilegios", \
          "category" : "redteam", \
          "url"      : "/2022-02-05-Escalada_de_privilegios/", \
          "date"     : "February  5, 2022" \
        }, \
       \
        { \
          "title"    : "Metasploit", \
          "category" : "redteam", \
          "url"      : "/2022-02-04-Metasploit_B%C3%A1sico/", \
          "date"     : "February  4, 2022" \
        }, \
       \
        { \
          "title"    : "Ataques a aplicaciones Android", \
          "category" : "redteam", \
          "url"      : "/2022-02-03-Ataques_aplicaciones_android/", \
          "date"     : "February  3, 2022" \
        }, \
       \
        { \
          "title"    : "Ataque a aplicaciones web.", \
          "category" : "redteam", \
          "url"      : "/2022-02-02-Ataques_a_aplicaciones_web/", \
          "date"     : "February  2, 2022" \
        }, \
       \
        { \
          "title"    : "Ataques a Infraestructuras y Redes", \
          "category" : "redteam", \
          "url"      : "/2022-02-01-Ataques_a_Infraestructuras_y_Redes/", \
          "date"     : "February  1, 2022" \
        }, \
       \
        { \
          "title"    : "Análisis de Objetivos", \
          "category" : "redteam", \
          "url"      : "/2022-01-28-An%C3%A1lisis_de_Objetivos/", \
          "date"     : "January 28, 2022" \
        }, \
       \
       \
        { \
          "title"    : "Blueteam Basics", \
          "category" : "page", \
          "url"      : "/BLUETEAMBASICSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "PortSwigger BurpSuite Course", \
          "category" : "page", \
          "url"      : "/BURPSUITEpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "C programming subjects.", \
          "category" : "page", \
          "url"      : "/Cpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Dharma Fuzzer language", \
          "category" : "page", \
          "url"      : "/DHARMApage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Exploiting &amp; Reversing", \
          "category" : "page", \
          "url"      : "/EXPREVpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Fuzzing JavaScript Engine", \
          "category" : "page", \
          "url"      : "/Fuzzpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "HackTheBox", \
          "category" : "page", \
          "url"      : "/HackTheBoxpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "PEN200 notes", \
          "category" : "page", \
          "url"      : "/PEN200page/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Proyectos", \
          "category" : "page", \
          "url"      : "/PROJECTSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Networking Basics", \
          "category" : "page", \
          "url"      : "/REDESpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "RedTeam Basics", \
          "category" : "page", \
          "url"      : "/REDTEAMBASICSpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Retired Machines", \
          "category" : "page", \
          "url"      : "/RetiredMachinespage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "TryHackMe", \
          "category" : "page", \
          "url"      : "/THMpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "About me", \
          "category" : "page", \
          "url"      : "/aboutme/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "THM", \
          "category" : "page", \
          "url"      : "/preOSCPpage/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Tag Index", \
          "category" : "page", \
          "url"      : "/tags/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page2/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page3/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page4/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page5/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page6/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page7/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page8/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page9/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page10/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page11/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page12/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page13/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page14/", \
          "date"     : "January 1, 1970" \
        }, \
       \
        { \
          "title"    : "Germán Sanmillán", \
          "category" : "page", \
          "url"      : "/page15/", \
          "date"     : "January 1, 1970" \
        } \
       \
    ]';
    searchjson = JSON.parse(searchjson);

    var sjs = SimpleJekyllSearch({
      searchInput: document.getElementById('nav-search-input'),
      resultsContainer: document.getElementById('search-results-container'),
      json: searchjson
    });
  </script>
</div>





  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>4. Command Injection.</h1>
          
            
              <h2 class="post-subheading">Detección y explotación de vulnerabilidades de inyección de comandos a través de la herramienta BurpSuite.</h2>
            
          

          
            <span class="post-meta">Posted on March 9, 2022</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <h2 id="0-índice">0. Índice.</h2>

<ul>
  <li>1 Introducción.</li>
  <li>2 Concepto de OS Command.</li>
  <li>3 Inyección de comandos.
    <ul>
      <li>3.1. Explotando una vulnerabilidad de inyección de comandos</li>
      <li>3.2. Comandos útiles</li>
    </ul>
  </li>
  <li>4 Inyección de comandos ciega
    <ul>
      <li>4.1. Concepto de vulnerabilidad de inyección de comandos ciega</li>
      <li>4.2. Técnicas de detección y explotación de vulnerabilidades ciega
        <ul>
          <li>4.2.1. Detectando OS command injection utilizando time delays</li>
          <li>4.2.2. Explotando una OS Command Injection redirijiendo output</li>
          <li>4.2.3. Explotando una vulnerabilidad OS comand injection utilizando OAST</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>5 Términos concatenadores de comandos</p>

    <p><br /></p>
  </li>
</ul>

<h3 id="1-introducción">1. Introducción</h3>
<p>En esta sección explicaremos qué es el OS command injection (Operating System Command Injection), describiremos cómo detectar vulnerabilidades, cómo explotarlas. Especificaremos diferentes comandos útiles para distintos sistemas operativos.</p>

<p><br /></p>

<h3 id="2-concepto-de-os-command-injection">2. Concepto de OS Command Injection.</h3>

<p>OS Command Injection, también conocido como Shell Injection, es una vulnerabilidad web que permite a un atacante ejecutar comandos arbitrarios en el servidor que está corriendo una aplicación web y que generalmente compromete la propia aplicación y todos sus datos.</p>

<p>Muy a menudo, un atacante puede escalar un OS Command Injection para comprometer otras partes de la infraestructura del host (pivoting).</p>

<p><br /></p>

<h3 id="3-inyección-de-comandos">3. Inyección de comandos.</h3>

<h4 id="31-explotando-una-vulnerabilidad-de-inyección-de-comandos">3.1. Explotando una vulnerabilidad de inyección de comandos.</h4>

<p>Para entender mejor cómo es una vulnerabilidad de inyección de comandos vamos a realizar un ejemplo.</p>

<p>Consideremos una tienda online que permite al usaurio ver si un item se encuentra en stock en una tienda en particular. Esta petición se procesa a través de la siguiente URL:</p>

<pre><code class="language-default">https://insecure-website.com/stockStatus?productID=381&amp;storeID=29
</code></pre>

<p>A su vez, para poder proveer la información del stock, la aplicación debe realizar una serie de búsquedas a sistemas anticuados (legacy system) que por razones históricas la funcionalidad se implementó llamando a shells de comandos en los que se introducía un comando y unos argumentos para obtener la información requerida:</p>

<pre><code class="language-default">stockreport.pl 381 29
</code></pre>

<p>Este comando muestra el estado del stock para un item específico, información que se le muestra seguidamente al usuario.</p>

<p>Como la aplicación no implementa defensas frente a un ataque de inyección de comandos un atacante puede introducir el siguiente input en la URL para ejecutar comandos arbitrarios:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp; <span class="nb">echo </span>aiwefwlguh &amp;
</code></pre></div></div>

<p>De esta forma, la query de búsqueda quedaría:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stockreport.pl &amp; <span class="nb">echo </span>aiwefwlguh &amp; 29
</code></pre></div></div>

<p>No hay errores de sintaxis y el comando se ejecuta satisfactoriamente.</p>

<p>Esto no es más que una prueba para verificar que efectivamente la aplicación es vulnerable a una inyección de comandos. Si efectivamente lo es la página devolverá el string “aiwefwlguh”.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error - productID was not found
aiwefwlguh
29: <span class="nb">command </span>not found
</code></pre></div></div>

<p><br /></p>

<p><strong>Laboratorio 1: OS command injection, simple case</strong>.</p>

<p>El laboratorio contiene una vulnerabilidad de inyección de comandos en el parámetro que comprueba el stock de un producto. Tal aplicación ejecuta una shell en la que introduce a modo de argumentos el valor de los parámetros de la petición del usuario.</p>

<p>Así, se tiene que vamos a ver los detalles de cualquier producto e interceptamos la petición cuando pulsamos el botón de ‘Check Stock’ situado en la parte inferior de la página:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405105041.png" text-align="center" />
</div>

<p>Y cambiamos el valor del parámetro storeid a ‘;whoami’ para concatenar el comando deseado:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405105122.png" text-align="center" />
</div>

<p>Obteniendo finalmente:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405105140.png" text-align="center" />
</div>

<p>Y hemos resuelto el laboratorio.</p>

<p><br /></p>

<h4 id="32-comandos-útiles">3.2. Comandos útiles.</h4>

<p>Los comandos a introducir, evidentemente, pueden variar en función del sistema operativo del servidor.</p>

<table>
  <thead>
    <tr>
      <th>Comando</th>
      <th>Linux</th>
      <th>Windows</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Nombre del usuario</td>
      <td>whoami</td>
      <td>whoami</td>
    </tr>
    <tr>
      <td>Sistema Operativo</td>
      <td>uname -a</td>
      <td>ver</td>
    </tr>
    <tr>
      <td>Configuración de red</td>
      <td>ifconfig</td>
      <td>ipconfig/all</td>
    </tr>
    <tr>
      <td>Conexiones de red</td>
      <td>netstat -an</td>
      <td>netstat -an</td>
    </tr>
    <tr>
      <td>Procesos en ejecución</td>
      <td>ps -ef</td>
      <td>tasklist</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h3 id="4-inyección-de-comandos-ciega">4. Inyección de comandos ciega.</h3>

<h4 id="41-concepto-de-vulnerabilidad-de-inyección-de-comandos-ciega">4.1. Concepto de vulnerabilidad de inyección de comandos ciega.</h4>
<p>Una vulnerabilidad de inyección de comandos ciega hace referencia a una inyección de comandos en la que la aplicación no devuelve output.</p>

<p>Esta clase de vulnerabilidades siguen siendo explotables aunque se requieren de técnicas un poco distintas.</p>

<p>Por ejemplo, consideremos un sitio web que permite a un usuario introducir comentarios u opiniones (feedback) sobre el sitio. Los usuarios ponen su email y su mensaje.</p>

<p>A su vez, la aplicación en el lado del servidor genera un email al lado del administrador llamando al programa ‘mail’ por ejemplo de la siguiente manera:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mail <span class="nt">-s</span> <span class="s2">"feedback_message"</span> <span class="nt">-a</span> From:peter@normal-user.net feedback@vulnerable-website.com
</code></pre></div></div>

<p>De esta manera, el feedback_message no se devuelve al usuario y por tanto la técnica del ‘echo’ ya no resulta efectiva.</p>

<p><br /></p>

<h4 id="42-técnicas-de-detección-y-explotación-de-vulnerabilidades-ciega">4.2. Técnicas de detección y explotación de vulnerabilidades ciega.</h4>

<p><br /></p>

<h5 id="421-detectando-os-command-injection-utilizando-time-delays">4.2.1. Detectando OS command injection utilizando time delays.</h5>

<p>En lugar de utilizar el comando “echo” podemos emplear el comando “ping” junton con el bucle local para que se haga ping a si mismo.</p>

<p>Cada paquete de ping dura un segundo, luego si en el caso anterior un usuario enviará un mensaje con el siguiente contenido: “ &amp; ping -c3 127.0.0.1 &amp; “, esto se traduciría en el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mail <span class="nt">-s</span> <span class="s2">""</span> &amp; ping <span class="nt">-c10</span> 127.0.0.1 &amp; <span class="s2">""</span> <span class="nt">-a</span> From:peter@normal-user.net feedback@vulnerable-website.com
</code></pre></div></div>

<p>Se tiene que el servidor tardaría 10 segundos en devolver la respuesta http.</p>

<p>Aunque evidentemente el formato a introducir cambiará en función de la forma que tenga el servidor de procesar el mensaje.</p>

<p><br /></p>

<p><strong>Laboratorio 2: Blind OS command injection with time delays</strong>.</p>

<p>El siguiente laboratorio tiene una OS command injection en algún parámetro de la request que se realiza cuando mandamos un comentario de feedback del sitio web.</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405180238.png" text-align="center" />
</div>

<p>Interceptando dicha request con el proxy de burp y seguidamente envíandolo hacía el repetidor podemos probar a intercalar el término “; ping -c10 127.0.0.1 &amp;” para concatenar un ping y ver cuándo el servidor tarda 10 segundos en darnos la respuesta:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405180536.png" text-align="center" />
</div>

<p>Podemos ver que introduciendo dicho término en el paramtetro ‘email’ finalmente obtenemos un delay de 10 segundos.</p>

<p><br /></p>

<h5 id="422-explotando-una-os-command-injection-redirijiendo-output">4.2.2. Explotando una OS Command Injection redirijiendo output.</h5>

<p>También podemos probar a redirigir el output del comando que inyectamos a una parte del servidor web que puedes ver desde el navegador como ocurre en el caso de <strong>/var/www/static</strong> introduciendo:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&amp; <span class="nb">whoami</span> <span class="o">&gt;</span> /var/www/whoami.txt &amp;
</code></pre></div></div>

<p><br /></p>

<p><strong>Laboratorio 3: Blind OS command injection with output redirection</strong>.</p>

<p>Este laboratorio contiene una OS command injection vulnerability en la función feedback. El objetivo es conseguir ver el output del comando inyectado enviándolo a un directorio con permisos de escritura: /var/www/images/</p>

<p>Luego, hacer una request de la URL a ese directorio para poder tener acceso al output.</p>

<table>
  <tbody>
    <tr>
      <td>Interceptamos la request de feedback, la modificamos adecuadamente introduciendo en el valor del parámetro email:</td>
      <td> </td>
      <td>whoami&gt;/var/www/images/output.txt</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Y seguidamente intentamos ver una de las fotos y cambiamos el valor del parámetro filename a output.txt:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220405184126.png" text-align="center" />
</div>

<p><br /></p>

<h5 id="423-explotando-una-vulnerabilidad-os-comand-injection-utilizando-oast">4.2.3. Explotando una vulnerabilidad OS comand injection utilizando OAST.</h5>

<p>También podemos emplear la téncica OAST como lo hemos hecho en el apartado de SQLi para inyectar un payload que entre otras cosas haga una interacción con un sistema que nosotros podamos ver como el client BurpCollaborator.</p>

<p><br /></p>

<p><strong>Laboratorio 4: Blind OS command injetion with out-of-band interaction</strong></p>

<p>Este laboratorio contiene una vulnerabilidad de inyección de comandos ciega en la función de feedback. La aplicación ejecuta un comando de shell que contiene los detalles proporcionados por el usuario. El comando se ejecuta de forma asíncrona y no tiene efecto en la respuesta de la aplicación. No es posible redirigir la salida a una ubicación a la que pueda acceder. Sin embargo, puede desencadenar interacciones fuera de banda con un dominio externo</p>

<p>En primer lugar, accedemos al laboratorio en el que sabemos que el parámetro vulnerable a la inyección de comandos es el parámetro email e introducimos el siguiente payload:</p>

<pre><code class="language-default">email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN||
</code></pre>

<p>De esa forma haremos una búsqueda DNS.</p>

<p><br /></p>

<p><strong>Laboratorio 5: Blind OS command injection with out-of-band data exfiltration</strong></p>

<p>Esta práctica de laboratorio contiene una vulnerabilidad de inyección de comandos ciegos del sistema operativo en la función de feedback.</p>

<p>La aplicación ejecuta un comando de shell que contiene los detalles proporcionados por el usuario. El comando se ejecuta de forma asíncrona y no tiene efecto en la respuesta de la aplicación. No es posible redirigir la salida a una ubicación a la que pueda acceder. Sin embargo, puede desencadenar interacciones fuera de banda con un dominio externo.</p>

<p>Para resolver el laboratorio, ejecute el comando whoami y extraiga el resultado a través de una consulta de DNS a Burp Collaborator. Deberá ingresar el nombre del usuario actual para completar el laboratorio.</p>

<p>De nuevo, ingresamos en el laboratorio y lo primero que hacemos es cargar el cliente de BurpCollaborator tal y como hicimos en SQLi:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220509231115.png" text-align="center" />
</div>

<p>Y le damos a copy clickboard para copiar el subdominio del servidor:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220509231142.png" text-align="center" />
</div>

<p>Sencillamente accedemos a la funcionalidad feedback, interceptamos la request y copiamos el payload que proporciona la solución del laboratorio.</p>

<p>De vuelta sobre el menu del BurpCollaborator Client veremos el nombre del usuario que ha hecho las búsquedas:</p>

<div style="text-align:center">
	<img src="/assets/img/Burp/Pasted%20image%2020220509232700.png" text-align="center" />
</div>

<h3 id="5-términos-concatenadores-de-comandos">5. Términos concatenadores de comandos.</h3>

<p>A variety of shell metacharacters can be used to perform OS command injection attacks.</p>

<p>A number of characters function as command separators, allowing commands to be chained together. The following command separators work on both Windows and Unix-based systems:</p>

<ul>
  <li>&amp;</li>
  <li>&amp;&amp;</li>
  <li>|</li>
  <li>| |</li>
</ul>

<p>The following command separators work only on Unix-based systems:</p>

<ul>
  <li>;</li>
  <li>Newline (0x0a or \n)</li>
</ul>

<p>On Unix-based systems, you can also use backticks or the dollar character to perform inline execution of an injected command within the original command:</p>

<ul>
  <li>injected command</li>
  <li>$(injected command)</li>
</ul>

<p>Note that the different shell metacharacters have subtly different behaviors that might affect whether they work in certain situations, and whether they allow in-band retrieval of command output or are useful only for blind exploitation.</p>

<p>Sometimes, the input that you control appears within quotation marks in the original command. In this situation, you need to terminate the quoted context (using “ or ‘) before using suitable shell metacharacters to inject a new command.</p>


      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#burp">burp</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a href="https://twitter.com/intent/tweet?text=4.+Command+Injection.&url=http%3A%2F%2Flocalhost%3A4000%2F2022-03-09-4.Command_Injection%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2022-03-09-4.Command_Injection%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2022-03-09-4.Command_Injection%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2022-03-08-3.Directory_Traversal/" data-toggle="tooltip" data-placement="top" title="3. Directory Traversal.">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2022-03-10-5.Business_logic_vulnerabilities/" data-toggle="tooltip" data-placement="top" title="5. Bussiness Logic Vulnerabilities.">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  
  
  

  


  



    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a href="mailto:sanmillan.german@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/Qv1nTv5" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://twitter.com/Qvintvs1" title="Twitter">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Twitter</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://linkedin.com/in/german-sanmillan-68b308229/" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Qv1nTv5
        &nbsp;&bull;&nbsp;
      
      2024

      

      
      </p>
      <p class="theme-by text-muted">
        Powered by
        <a href="https://beautifuljekyll.com">Beautiful Jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
